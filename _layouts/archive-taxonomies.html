---
layout: default
---

{% include home-header.html %}

<h1>{{ page.title }}</h1>

{% comment %} Check the type of archive {% endcomment %}
{%- if page.type == 'categories' -%}
  {%- assign taxonomies = site.categories -%}
{%- elsif page.type == 'tags' -%}
  {%- assign taxonomies = site.tags -%}
{%- else -%}
  {%- assign taxonomies = none -%}
{%- endif -%}

{% comment %} Calculate the max count of taxonomies {% endcomment %}
{%- assign max_count = 0 -%}
{%- for taxonomy in taxonomies -%}
  {%- assign posts = taxonomy[1] -%}
  {%- if posts.size > max_count -%}
    {%- assign max_count = posts.size -%}
  {%- endif -%}
{%- endfor -%}

<div class="taxonomies-wrapper">
  <ul class="taxonomies">
    {%- for i in (1..max_count) reversed -%}
      {%- for taxonomy in taxonomies -%}
        {%- assign taxonomy_name = taxonomy[0] -%}
        {%- assign slugified_taxonomy_name = taxonomy_name | slugify -%}
        {%- assign posts = taxonomy[1] -%}
        {%- if posts.size == i -%}
          <li>
            {%- capture link -%}{{ page.permalink }}#{{ slugified_taxonomy_name }}{%- endcapture -%}
            <a class="taxonomy" href="{{ link | relative_url }}">
              <span>
                {%- if page.type == 'tags' -%}
                  {{ slugified_taxonomy_name }}
                {%- else -%}
                  {{ taxonomy_name }}
                {%- endif -%}
              </span>
              <span class="taxonomy-count">{{ posts.size }}</span>
            </a>
          </li>
        {%- endif -%}
      {%- endfor -%}
    {%- endfor -%}
  </ul>
</div>

{% comment %} Show posts by taxonomy {% endcomment %}
{%- for i in (1..max_count) reversed -%}
  {%- for taxonomy in taxonomies -%}
    {%- assign taxonomy_name = taxonomy[0] -%}
    {%- assign slugified_taxonomy_name = taxonomy_name | slugify -%}
      {%- assign posts = taxonomy[1] -%}
      {%- if posts.size == i -%}
        <h2 id="{{ slugified_taxonomy_name }}">
          {%- if page.type == 'tags' -%}
            {{ slugified_taxonomy_name }}
          {%- else -%}
            {{ taxonomy_name }}
          {%- endif -%}
        </h2>
        <ul class="post-list">
          {%- for post in posts -%}
            <section class="post-entry">
              <div class="post">
                <a href="{{ post.url | relative_url }}">
                  <figure class="tint">  
                    <img class= "feed-img" src= "{{post.feed-img}}" alt="Image of {{post.title}}"/>
                  </figure>
                </a>
                 <h2 class="card-title">{{ post.title }}</h2>
                <h2 class="post-description">{{ post.description | strip_html }}</h2>
              </div>
            </section>
          {%- endfor -%}
        </ul>
        {%- endif -%}
  {%- endfor -%}
{%- endfor -%}